<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login Administrador</title>
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="./login_Administrador.css">
</head>
<body>
  <div class="login-container">
    <form id="formLoginAdmin" class="login-form" onsubmit="event.preventDefault(); submitLoginAdministrador();">
      <h2>Ingreso - Administrador</h2>
      <div class="field">
        <label for="user">Usuario</label>
        <input type="text" id="user" name="user" autocomplete="username" required />
      </div>
      <div class="field">
        <label for="pass">Contraseña</label>
        <input type="password" id="pass" name="pass" autocomplete="current-password" required />
      </div>
      <button type="button" class="btn" onclick="submitLoginAdministrador()">Entrar</button>

      <div id="errorMsgAdmin" class="error-message" role="alert" aria-live="polite"></div>
      <div class="small-note">Acceso restringido únicamente a administradores</div>
    </form>
  </div>

  <script src="../vistaWeb.js"></script>
  <script src="../utilesVista.js"></script>
  <script>
    function submitLoginAdministrador(){
      const err = document.getElementById('errorMsgAdmin');
      if(err){ err.style.display='none'; err.textContent=''; }

      const data = serializarFormulario('formLoginAdmin');
      submit('/acceso/loginAdministrador', data);
    }

    window['mostrar_Login Exitoso'] = function(parametro){
      if(typeof parametro === 'string' && parametro.endsWith('.html')){
        window.location.href = parametro;
        return;
      }
      try{ mostrarMensaje(parametro || 'Acceso correcto'); }catch(e){ alert(parametro); }
    }

    window.procesarErrorSubmit = function(status, text){
      const err = document.getElementById('errorMsgAdmin');
      const mensaje = (text && text.toString()) || ('Error ' + status);
      if(err){ err.textContent = mensaje; err.style.display = 'block'; }
      try{ mostrarMensaje(mensaje); }catch(e){ }
    }

    // VistaWeb.js invoca excepcionDeAplicacion cuando el servidor devuelve status 299
    function excepcionDeAplicacion(text){
      const err = document.getElementById('errorMsgAdmin');
      const mensaje = (text && text.toString()) || 'Error de aplicación';
      if(err){ err.textContent = mensaje; err.style.display = 'block'; }
      try{ mostrarMensaje(mensaje); }catch(e){}
    }
  </script>
</body>
</html>
